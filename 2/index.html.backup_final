<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>&#350;evval'in &Ccedil;eyiz Defteri</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="list-layout-refinement.css">
    <link rel="stylesheet" href="checkbox-animations.css">
    <link rel="stylesheet" href="home-refinements.css">
    <link rel="stylesheet" href="special-message-animations.css">
    <link rel="stylesheet" href="dark-mode-additions.css">
    <link rel="stylesheet" href="swipe-nav.css">
    <link rel="stylesheet" href="infinity-animation.css">
    <link rel="stylesheet" href="nikah-animation.css">
    <link rel="stylesheet" href="splash-design.css">
    <link rel="stylesheet" href="splash-infinity-animation.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <!-- Header -->
    <header class="app-header">
        <div class="header-left">
            <h1 id="page-title">&#350;evval'in &Ccedil;eyiz Defteri <i class="fas fa-heart pulse-heart"></i></h1>
            <p class="header-subtitle">Birlikte kuraca&#287;&#305;m&#305;z evin tatl&#305; listesi</p>
        </div>
        <div class="header-actions">

            <!-- Dark Mode Toggle -->
            <button id="btn-dark-mode-toggle" class="icon-btn" title="Karanlık Mod">
                <i class="fas fa-moon"></i>
            </button>
            <!-- Settings Toggle -->
            <button id="btn-settings" title="Ayarlar" onclick="window.openSettings && window.openSettings()"><i
                    class="fas fa-cog"></i></button>
        </div>
    </header>

    <!-- Main Content Area -->
    <!-- Splash Screen (Always On) -->
    <div id="splash-screen" class="ethereal-splash">
        <!-- Splash Theme Toggle Removed per user request -->

        <div class="splash-content">
            <div class="splash-icon">
                <svg viewBox="0 0 200 200" class="puffy-heart-svg">
                    <defs>
                        <linearGradient id="heartGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#ffffff" />
                            <stop offset="45%" style="stop-color:var(--primary-color)" />
                            <stop offset="100%" style="stop-color:var(--primary-dark)" />
                        </linearGradient>
                        <filter id="puffy-glow">
                            <feGaussianBlur stdDeviation="5" result="blur" />
                            <feComposite in="SourceGraphic" in2="blur" operator="over" />
                        </filter>
                    </defs>
                    <path
                        d="M100 180c-5-5-95-55-95-115 0-35 25-60 55-60 15 0 30 10 40 25 10-15 25-25 40-25 30 0 55 25 55 60 0 60-90 110-95 115z"
                        fill="url(#heartGradient)" filter="url(#puffy-glow)" />
                </svg>
            </div>
            <h1 class="splash-names">
                <span class="name-line" id="splash-name-bride">Şevval</span>
                <div class="infinity-container splash-infinity">
                    <svg class="infinity-svg" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">
                        <path class="infinity-path"
                            d="M30 15C10 15 10 35 30 35C45 35 55 15 70 15C90 15 90 35 70 35C55 35 45 15 30 15" />
                    </svg>
                </div>
                <span class="name-line" id="splash-name-groom">Yusuf</span>
            </h1>
            <!-- Decorative Heart Separator -->
            <div class="splash-separator">
                <div class="sep-line"></div>
                <i class="fas fa-heart sep-icon"></i>
                <div class="sep-line"></div>
            </div>

            <p class="splash-subtitle">Mutlulu&#287;a Do&#287;ru...</p>

            <div class="splash-countdown">
                <div class="splash-item">
                    <div class="sp-icon-wrapper">
                        <i class="fas fa-hand-holding-heart"></i>
                    </div>
                    <span class="sp-label">Ni&#351;an</span>
                    <span class="sp-time" id="splash-nisan">...</span>
                </div>

                <div class="splash-item">
                    <div class="sp-icon-wrapper">
                        <i class="fas fa-home"></i>
                        <!-- Using home as it's cuter/cozier than church -->
                    </div>
                    <span class="sp-label">Nikah</span>
                    <span class="sp-time" id="splash-nikah">...</span>
                </div>
            </div>

            <!-- New: Upcoming Calendar Note for Splash -->
            <div id="splash-next-event" class="hidden">
                <div class="next-event-tag">SIRADAKİ GÜN ✨</div>
                <div class="next-event-content" id="splash-next-msg">...</div>
            </div>

            <div class="splash-hint">
                <i class="fas fa-chevron-up"></i>
            </div>


        </div>
    </div>

    <!-- ACIL FIX: Splash Sayacını Başlat -->
    <script src="splash-fix.js"></script>

    <main id="app-container">

        <!-- Section: Home (Landing Screen) -->
        <section id="landing-wrapper" class="active-section">

            <!-- Carousel moved inside home section -->

            <!-- Swipe Navigation Wrapper -->
            <div class="swipe-viewport">
                <div class="swipe-container" id="main-swipe-container">

                    <!-- Section: Home -->
                    <section id="home-section" class="swipe-section">
                        <!-- Greeting Section Removed -->

                        <!-- Countdown Card (Unified) -->
                        <!-- Carousel Wrapper -->
                        <div class="countdown-carousel-wrapper">
                            <div class="carousel-track" id="home-carousel-track">
                                <!-- SLIDE 1: Countdown -->
                                <div class="carousel-slide countdown-slide">
                                    <div class="unified-countdown-card">
                                        <div class="countdown-section nisan">
                                            <div class="infinity-container">
                                                <svg class="infinity-svg" viewBox="0 0 100 50"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path class="infinity-path"
                                                        d="M30 15C10 15 10 35 30 35C45 35 55 15 70 15C90 15 90 35 70 35C55 35 45 15 30 15" />
                                                </svg>
                                            </div>
                                            <div class="countdown-info">
                                                <span class="countdown-label">Ni&#351;an</span>
                                                <span class="countdown-date" id="home-nisan-date">01 Ekim 2026</span>
                                                <div class="countdown-timer" id="home-nisan-timer">Hesaplan&#305;yor...
                                                </div>
                                            </div>
                                        </div>
                                        <div class="countdown-divider"></div>
                                        <div class="countdown-section nikah">
                                            <div class="nikah-container">
                                                <svg class="nikah-svg" viewBox="0 0 100 100"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path class="heart-path heart-1"
                                                        d="M 40 40 C 40 30 20 30 20 45 C 20 60 40 75 40 75 C 40 75 60 60 60 45 C 60 30 40 30 40 40" />
                                                    <path class="heart-path heart-2"
                                                        d="M 60 40 C 60 30 40 30 40 45 C 40 60 60 75 60 75 C 60 75 80 60 80 45 C 80 30 60 30 60 40" />
                                                </svg>
                                            </div>
                                            <div class="countdown-info">
                                                <span class="countdown-label">Nikah</span>
                                                <span class="countdown-date" id="home-nikah-date">01 Ekim 2027</span>
                                                <div class="countdown-timer" id="home-nikah-timer">Hesaplan&#305;yor...
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- SLIDE 2: Calendar -->
                                <div class="carousel-slide calendar-slide">
                                    <div class="calendar-card unified-countdown-card calendar-mode">
                                        <div class="calendar-header">
                                            <button class="cal-nav-btn prev" id="cal-prev-month"><i
                                                    class="fas fa-chevron-left"></i></button>
                                            <span class="cal-month-year" id="cal-month-year">Ocak 2026</span>
                                            <button class="cal-nav-btn next" id="cal-next-month"><i
                                                    class="fas fa-chevron-right"></i></button>
                                        </div>
                                        <div class="calendar-days-header">
                                            <span>Pzt</span><span>Sal</span><span>&Ccedil;ar</span><span>Per</span><span>Cum</span><span>Cmt</span><span>Paz</span>
                                        </div>
                                        <div class="calendar-grid mini-grid" id="calendar-grid">
                                            <!-- Days injected here -->
                                        </div>
                                    </div>
                                </div>

                                <!-- SLIDE 3: Upcoming Dates -->
                                <div class="carousel-slide upcoming-slide">
                                    <div class="unified-countdown-card upcoming-mode"
                                        style="flex-direction: column; align-items: flex-start; padding: 12px 16px !important; gap: 8px !important;">
                                        <div
                                            style="display: flex; align-items: center; gap: 10px; width: 100%; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid rgba(0,0,0,0.03);">
                                            <i class="fas fa-calendar-star"
                                                style="color: var(--primary-color); font-size: 1rem;"></i>
                                            <span
                                                style="font-size: 0.85rem; font-weight: 700; color: var(--primary-color); text-transform: uppercase; letter-spacing: 0.8px;">Yaklaşan
                                                Tarihler</span>
                                        </div>
                                        <div id="home-upcoming-list"
                                            style="width: 100%; display: flex; flex-direction: column; gap: 6px;">
                                            <!-- Injected via JS -->
                                            <div style="font-size: 0.8rem; color: var(--text-muted); opacity: 0.7;">
                                                Yükleniyor...</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Dots (Page Indicator) -->
                            <div class="carousel-dots-container">
                                <div class="c-dot active" data-slide="0"></div>
                                <div class="c-dot" data-slide="1"></div>
                                <div class="c-dot" data-slide="2"></div>
                            </div>


                        </div>

                        <!-- Mini Dashboard Removed per user request -->


                        <!-- Content from original home section -->
                        <div class="home-actions-wrapper">
                            <div class="home-actions" data-home-id="actions">
                                <button class="home-action-card ceyiz" data-nav="ceyiz">
                                    <div class="action-icon-circle"><i class="fas fa-list"></i></div>
                                    <div class="action-text">
                                        <span class="action-title">&Ccedil;eyiz Listesi</span>
                                        <span class="action-desc">Eksikleri Tamamla</span>
                                    </div>
                                    <i class="fas fa-chevron-right action-arrow"></i>
                                </button>
                                <button class="home-action-card damat" data-nav="damat">
                                    <div class="action-icon-circle"><i class="fas fa-suitcase"></i></div>
                                    <div class="action-text">
                                        <span class="action-title">Boh&ccedil;a Listesi</span>
                                        <span class="action-desc">Haz&#305;rl&#305;klar&#305; Y&ouml;net</span>
                                    </div>
                                    <i class="fas fa-chevron-right action-arrow"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Daily Quote Widget -->
                        <div class="daily-quote-widget" data-home-id="quote">
                            <div class="quote-icon">
                                <svg class="quote-heart-svg" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                                </svg>
                            </div>
                            <div class="quote-content">
                                <p class="quote-text" id="daily-quote-text">Bir yuva kurmak, iki kalbin
                                    birle&#351;mesiyle
                                    ba&#351;lar...
                                </p>
                            </div>
                            <div class="quote-label">G&uuml;n&uuml;n S&ouml;z&uuml;</div>
                        </div>
                    </section>

                    <!-- Section: Ceyiz Listesi -->
                    <section id="ceyiz-section" class="swipe-section">
                        <!-- Search Bar -->
                        <div class="search-container sticky-search">
                            <div class="search-wrapper">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" id="search-ceyiz" placeholder="&Ccedil;eyizimde ara..."
                                    class="search-input-modern">
                            </div>
                        </div>

                        <!-- List Container -->
                        <div id="ceyiz-list" class="item-list"></div>

                        <!-- Physical Spacer for scrolling reliability -->
                        <div class="list-bottom-spacer" style="height: 200px; width: 100%;"></div>
                        <div class="empty-state hidden">
                            <i class="far fa-heart"></i>
                            <p>Liste &#351;imdilik bo&#351; âœ¨<br>Sa&#287; alttaki + ile ilk
                                &uuml;r&uuml;n&uuml;n&uuml; ekleyelim mi?</p>
                        </div>
                    </section>

                    <!-- Section: Damat Bohcasi -->
                    <section id="damat-section" class="swipe-section">
                        <!-- Search Bar -->
                        <div class="search-container sticky-search">
                            <div class="search-wrapper">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" id="search-damat" placeholder="Boh&ccedil;ada ara..."
                                    class="search-input-modern">
                            </div>
                        </div>

                        <!-- List Container -->
                        <div id="damat-list" class="item-list"></div>

                        <!-- Physical Spacer for scrolling reliability -->
                        <div class="list-bottom-spacer" style="height: 200px; width: 100%;"></div>
                        <div class="empty-state hidden">
                            <i class="fas fa-gift"></i>
                            <p>Liste &#351;imdilik bo&#351; âœ¨<br>Sa&#287; alttaki + ile ilk
                                &uuml;r&uuml;n&uuml;n&uuml; ekleyelim mi?</p>
                        </div>
                    </section>

                    <!-- Section: Istatistikler (Redesigned) -->
                    <section id="stats-section" class="swipe-section">
                        <div class="stats-container" style="padding: 20px; padding-bottom: 150px;">

                            <!-- 1. Hero Budget Card -->
                            <div class="stat-hero-card">
                                <div class="hero-header">
                                    <h3>Bütçe Özeti</h3>
                                    <div class="hero-actions" style="display: flex; gap: 10px;">
                                        <div class="hero-icon" id="btn-edit-budget" style="cursor: pointer;"><i
                                                class="fas fa-pencil-alt"></i></div>
                                        <div class="hero-icon"><i class="fas fa-wallet"></i></div>
                                    </div>
                                </div>
                                <div class="hero-main-val">
                                    <span class="currency">₺</span><span id="stat-total-money">0</span>
                                    <span class="label">Tahmini Toplam</span>
                                </div>
                                <div class="hero-grid">
                                    <div class="hero-item spent">
                                        <span class="label">Harcanan ve alınanlar</span>
                                        <span class="val" id="stat-spent-money">₺0</span>
                                    </div>
                                    <div class="hero-separator"></div>
                                    <div class="hero-item remaining">
                                        <span class="label">Kalan İhtiyaç</span>
                                        <span class="val" id="stat-remaining-money">₺0</span>
                                    </div>
                                </div>
                                <div class="budget-gauge">
                                    <div class="gauge-fill" id="budget-gauge-fill" style="width: 0%"></div>
                                </div>
                            </div>

                            <!-- 2. Main Progress Cards -->
                            <div class="stat-grid-2">
                                <!-- General Status -->
                                <div class="stat-card modern clickable-card" id="btn-show-history"
                                    style="cursor: pointer; position: relative;">
                                    <div class="stat-card-header">
                                        <h4>Harcama Geçmişi</h4>
                                        <span class="badge-pill" id="total-pct-badge">%0</span>
                                    </div>
                                    <div class="circular-progress-container">
                                        <svg class="progress-ring" width="80" height="80">
                                            <circle class="progress-ring-bg" stroke="var(--border-color)"
                                                stroke-width="6" fill="transparent" r="34" cx="40" cy="40" />
                                            <circle class="progress-ring-circle" id="total-progress-ring"
                                                stroke="var(--primary-color)" stroke-width="6" fill="transparent" r="34"
                                                cx="40" cy="40" />
                                        </svg>
                                        <div class="progress-inner-text">
                                            <span id="total-items-count">0</span>
                                            <small>Ürün</small>
                                        </div>
                                    </div>
                                    <div class="stat-footer-text">
                                        <span class="success-text"><i class="fas fa-check"></i> <span
                                                id="total-bought-count">0</span> Alındı</span>
                                    </div>
                                </div>

                                <!-- Lists Breakdown -->
                                <div class="stat-card modern"
                                    style="display:flex; flex-direction:column; justify-content:center; gap:10px;">
                                    <div class="mini-list-stat">
                                        <div class="mls-header">
                                            <span class="mls-icon ceyiza"><i class="fas fa-home"></i></span>
                                            <span>Çeyiz</span>
                                        </div>
                                        <div class="mls-bar-bg">
                                            <div class="mls-bar-fill" id="stat-ceyiz-bar" style="width:0%"></div>
                                        </div>
                                        <div class="mls-val" id="stat-ceyiz-ratio">0/0</div>
                                    </div>
                                    <div class="mini-list-stat">
                                        <div class="mls-header">
                                            <span class="mls-icon damata"><i class="fas fa-user-tie"></i></span>
                                            <span>Bohça</span>
                                        </div>
                                        <div class="mls-bar-bg">
                                            <div class="mls-bar-fill" id="stat-damat-bar" style="width:0%"></div>
                                        </div>
                                        <div class="mls-val" id="stat-damat-ratio">0/0</div>
                                    </div>
                                </div>
                            </div>

                            <!-- 3. Category Breakdown -->
                            <div class="stat-section-title">
                                <h3>Harcama Dağılımı</h3>
                                <small>Kategorilere göre harcamalar</small>
                            </div>
                            <div class="stat-card modern" id="category-breakdown-container">
                                <!-- Injected via JS -->
                                <div class="empty-chart-msg">Veri yok</div>
                            </div>

                            <!-- 4. Recent Activity -->
                            <div class="stat-section-title" style="margin-top: 20px;">
                                <h3>Son İşlemler</h3>
                                <small>Yakın zamanda alınanlar</small>
                            </div>
                            <div class="recent-activity-list" id="recent-activity-list">
                                <!-- Injected via JS -->
                            </div>

                        </div>
                    </section>

                </div>
            </div>

    </main>

    <!-- UI: Toast Notification (Undo/Success) -->
    <div id="toast-container" class="toast-container hidden">
        <span id="toast-message">Bildirim</span>
        <button id="btn-undo" class="hidden">Geri Al</button>
    </div>

    <!-- UI: Fixed Countdown Widget -->
    <div id="fixed-countdown-widget" class="fixed-countdown hidden">
        <div class="fc-row">
            <span class="fc-label">ğŸ’ Ni&#351;an:</span>
            <span class="fc-val" id="fc-nisan">...</span>
        </div>
        <div class="fc-row">
            <span class="fc-val" id="fc-nikah">...</span>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button id="fab-add" class="fab"><i class="fas fa-plus"></i></button>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active" data-target="home">
            <i class="fas fa-home"></i>
            <span>Ana Sayfa</span>
        </a>
        <a href="#" class="nav-item" data-target="ceyiz">
            <i class="fas fa-ring"></i>
            <span>&Ccedil;eyiz</span>
        </a>
        <a href="#" class="nav-item" data-target="damat">
            <i class="fas fa-user-tie"></i>
            <span>Boh&ccedil;a</span>
        </a>
        <a href="#" class="nav-item" data-target="stats">
            <i class="fas fa-chart-pie"></i>
            <span>&#304;statistik</span>
        </a>
    </nav>

    <!-- Modals moved to Body scope to avoid transform/overflow clipping -->

    <!-- Day Details Modal (Calendar) -->
    <div id="modal-day-details" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet details-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 id="day-details-title">Tarih Detay&#305; ğŸ“…</h2>
                    <p class="sheet-subtitle" id="day-details-date">...</p>
                </div>
                <button class="close-modal-sheet" id="close-day-details" type="button"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="sheet-body" style="padding: 1.5rem;">
                <div class="form-group">
                    <label
                        style="display:block; margin-bottom:0.5rem; font-weight:500; color:var(--text-light);">Notunuz</label>
                    <textarea id="day-note-input" class="modern-input" rows="4"
                        placeholder="Bug&uuml;n i&ccedil;in bir not yaz&#305;n... (&Ouml;rn: Do&#287;um G&uuml;n&uuml;)"></textarea>
                </div>

                <div class="modal-actions full-width" style="margin-top: 1.5rem;">
                    <button id="btn-save-day" class="btn-primary" style="flex: 2;">Kaydet</button>
                    <button id="btn-delete-day" class="btn-ghost danger" style="flex: 1; display: none;">Sil</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Full Calendar Modal Removed (Duplicate) -->

    <!-- Start Add/Edit Modal (Modern Sheet Design) -->
    <!-- Unified Item Editor Modal (New) -->
    <div id="modal-item-editor" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet editor-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title" id="editor-title">Ürün Ekle/Düzenle</h2>
                    <p class="sheet-subtitle">Ürün detaylarını aşağıdan yönetebilirsiniz.</p>
                </div>
                <button class="close-modal-sheet" type="button"><i class="fas fa-times"></i></button>
            </div>

            <!-- Processing Overlay (NEW) -->
            <div id="editor-processing-overlay" class="processing-overlay hidden">
                <div class="spinner"></div>
                <p>Fotoğraf işleniyor...</p>
            </div>

            <div class="sheet-body editor-body" style="padding: 1.5rem; overflow-y: auto;">
                <input type="hidden" id="editor-id">

                <!-- Section: Basic Info -->
                <div class="editor-section">
                    <h3 class="section-label">Temel Bilgiler</h3>
                    <div class="form-grid">
                        <div class="field">
                            <span>Ürün Adı</span>
                            <input type="text" id="editor-name" placeholder="Örn: Yemek Takımı" class="modern-input">
                        </div>
                        <div class="field">
                            <span>Kategori</span>
                            <select id="editor-category" class="modern-input">
                                <option value="" disabled selected>Seçiniz</option>
                            </select>
                            <!-- Inline New Category Input -->
                            <div id="editor-new-cat-container" class="hidden" style="margin-top: 5px;">
                                <input type="text" id="editor-new-cat-input" placeholder="Yeni kategori ismi..."
                                    class="modern-input" style="border-color: var(--primary-color);">
                            </div>
                        </div>
                    </div>
                    <div class="form-grid" style="margin-top: 10px;">
                        <div class="field">
                            <span>Adet</span>
                            <input type="number" id="editor-qty" value="1" min="1" class="modern-input">
                        </div>
                        <div class="field">
                            <span>Birim Fiyat (TL)</span>
                            <input type="number" id="editor-price" placeholder="0.00" class="modern-input">
                        </div>
                    </div>
                    <div class="form-group checkbox-group"
                        style="margin-top: 15px; display:flex; align-items:center; gap:8px;">
                        <input type="checkbox" id="editor-bought"
                            style="width:18px; height:18px; accent-color:var(--primary-color);">
                        <label for="editor-bought" style="cursor:pointer; color:var(--text-color);">Alındı olarak
                            işaretle</label>
                    </div>
                </div>

                <!-- Section: Media -->
                <div class="editor-section">
                    <h3 class="section-label">Fotoğraflar 📷</h3>
                    <div class="photo-upload-area" id="editor-drop-zone">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Fotoğrafları buraya sürükleyin veya seçin</p>
                        <input type="file" id="editor-photo-input" accept="image/*" multiple hidden>
                        <button type="button" class="btn-ghost-sm"
                            onclick="document.getElementById('editor-photo-input').click()">Fotoğraf Seç</button>
                    </div>
                    <div id="editor-photo-grid" class="photo-grid">
                        <!-- Photos injected here -->
                    </div>
                </div>

                <!-- Section: Details (Notes & Links) -->
                <div class="editor-section">
                    <h3 class="section-label">Detaylar & Bağlantılar 🔗</h3>

                    <div class="field" style="margin-bottom: 10px;">
                        <span>Notlar</span>
                        <textarea id="editor-note" rows="3" class="modern-textarea"
                            placeholder="Renk, model, mağaza vb. notlar..."></textarea>
                    </div>

                    <div class="links-manager">
                        <label>Alışveriş Linkleri</label>
                        <div id="editor-links-list" class="links-list">
                            <!-- Links injected here -->
                        </div>
                        <div class="add-link-row">
                            <input type="url" id="editor-link-input" placeholder="https://..." class="modern-input sm">
                            <button type="button" id="btn-add-link" class="btn-icon-turn"><i
                                    class="fas fa-plus"></i></button>
                        </div>
                    </div>
                </div>

            </div>

            <div class="sheet-footer modal-actions">
                <button class="btn-ghost close-modal-sheet">Vazgeç</button>
                <button id="btn-save-editor" class="btn-primary">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Budget Editor Modal -->
    <div id="modal-budget-editor" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet glass-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title">Bu Ayki Bütçe</h2>
                    <p class="sheet-subtitle">Bu ay harcayabileceğiniz limiti girin.</p>
                </div>
                <button class="close-modal-sheet" type="button"><i class="fas fa-times"></i></button>
            </div>
            <div class="sheet-body" style="padding: 1.5rem;">
                <div class="field">
                    <span>Mevcut Bütçe</span>
                    <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-color); margin-bottom: 15px;"
                        id="budget-current-display">0 TL</div>

                    <span>İşlem Tutarı (TL)</span>
                    <input type="number" id="budget-input" placeholder="Örn: 10000" class="modern-input"
                        style="font-size: 1.2rem; font-weight: 600;">

                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button id="btn-budget-add" class="btn-secondary budget-calc-btn add">
                            <i class="fas fa-plus"></i> Ekle
                        </button>
                        <button id="btn-budget-sub" class="btn-secondary budget-calc-btn sub">
                            <i class="fas fa-minus"></i> Çıkar
                        </button>
                    </div>

                    <small style="display:block; margin-top:12px; color:var(--text-light);">
                        İşlem yapmadan direkt yeni tutarı kaydetmek için "Kaydet"i kullanabilirsiniz.
                    </small>
                </div>
                <div style="margin-top: 20px; display: flex; flex-direction: column; gap: 10px;">
                    <button id="btn-save-budget" class="btn-primary" style="width: 100%;">Kaydet</button>
                    <button id="btn-reset-budget" class="btn-ghost danger"
                        style="width: 100%; border: 1px solid #e57373; color: #e57373;">
                        <i class="fas fa-undo-alt"></i> Bu Ayki Bütçeyi Sıfırla
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Weekly Goal Editor Modal -->
    <div id="modal-weekly-goal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet glass-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title">Haftalık Hedefimiz</h2>
                    <p class="sheet-subtitle">Bu hafta odaklanacağımız güzel bir hedef belirleyelim.</p>
                </div>
                <button class="close-modal-sheet" type="button"><i class="fas fa-times"></i></button>
            </div>
            <div class="sheet-body" style="padding: 1.5rem;">
                <div class="field">
                    <label
                        style="font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; margin-bottom: 8px; display: block;">Hedefini
                        Yaz</label>
                    <textarea id="weekly-goal-input" class="modern-input"
                        placeholder="Örn: Bu hafta davetiyeleri seçeceğiz..."
                        style="width: 100%; min-height: 100px; padding: 12px; font-size: 1rem; border-radius: 12px; resize: none;"></textarea>
                </div>
                <div style="margin-top: 20px;">
                    <button id="btn-save-weekly-goal" class="btn-primary" style="width: 100%;">Hedefi Kaydet</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Dates Editor Modal -->
    <div id="modal-dates-editor" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet glass-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title">Geri Sayım Ayarları</h2>
                    <p class="sheet-subtitle">Nişan ve Nikah tarihlerini buradan güncelleyebilirsin.</p>
                </div>
                <button class="close-modal-sheet" type="button"><i class="fas fa-times"></i></button>
            </div>
            <div class="sheet-body" style="padding: 1.5rem;">
                <div class="field" style="margin-bottom: 20px;">
                    <label
                        style="font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; margin-bottom: 8px; display: block;">Nişan
                        Tarihi</label>
                    <div class="input-with-icon">
                        <input type="text" id="input-date-nisan" class="modern-input" readonly
                            placeholder="Tarih Seçin..." style="width: 100%; cursor: pointer;">
                        <i class="fas fa-calendar-alt input-icon"></i>
                    </div>
                </div>
                <div class="field" style="margin-bottom: 20px;">
                    <label
                        style="font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; margin-bottom: 8px; display: block;">Nikah
                        Tarihi</label>
                    <div class="input-with-icon">
                        <input type="text" id="input-date-nikah" class="modern-input" readonly
                            placeholder="Tarih Seçin..." style="width: 100%; cursor: pointer;">
                        <i class="fas fa-calendar-alt input-icon"></i>
                    </div>
                </div>
                <div style="margin-top: 30px;">
                    <button id="btn-save-dates" class="btn-primary" style="width: 100%;">Tarihleri Güncelle</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Calendar Modal (Premium Picker) -->
    <div id="modal-custom-calendar" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet glass-sheet calendar-modal-fixed">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title" id="calendar-month-year" style="cursor: pointer;">Ocak 2026</h2>
                </div>
                <div class="calendar-nav">
                    <button class="cal-nav-btn" id="cal-prev"><i class="fas fa-arrow-left"></i></button>
                    <button class="cal-nav-btn" id="cal-next"><i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <div class="sheet-body calendar-body-custom">
                <!-- Days View -->
                <div id="calendar-days-view">
                    <div class="calendar-weekdays">
                        <span>Pt</span><span>Sa</span><span>Ça</span><span>Pe</span><span>Cu</span><span>Ct</span><span>Pa</span>
                    </div>
                    <div class="calendar-days" id="calendar-days-grid">
                        <!-- Days injected via JS -->
                    </div>
                </div>
                <!-- Years View -->
                <div id="calendar-years-view" class="hidden">
                    <div class="calendar-years" id="calendar-years-grid">
                        <!-- Years injected via JS -->
                    </div>
                </div>
            </div>
            <div class="calendar-footer" style="padding: 1rem; border-top: 1px solid var(--border-color);">
                <button id="close-custom-calendar" class="btn-primary sm" style="width: 100%;"
                    type="button">Kapat</button>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal (Updated) -->
    <div id="modal-product-detail" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet detail-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title" id="detail-title">Ürün Detayı</h2>
                </div>
                <div class="sheet-actions">
                    <button id="btn-edit-detail" class="btn-icon-sm"
                        style="color:var(--primary-color); margin-right:10px;">
                        <i class="fas fa-pen"></i>
                    </button>
                    <button class="close-modal-sheet close-detail-modal" type="button">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <div class="sheet-body detail-body" style="padding: 1.5rem; overflow-y: auto;">

                <!-- Gallery Widget -->
                <div id="detail-gallery" class="detail-gallery-container hidden">
                    <div class="gallery-wrapper" id="gallery-track">
                        <!-- Images injected here -->
                    </div>
                    <div class="gallery-dots" id="gallery-dots"></div>
                </div>

                <!-- Info Header -->
                <div class="detail-h-group">
                    <span id="detail-category" class="detail-badge">Kategori</span>
                    <span id="detail-price" class="detail-price">₺0</span>
                </div>

                <!-- Links Section -->
                <div id="detail-links-section" class="detail-links-box hidden">
                    <label>Bağlantılar</label>
                    <div id="detail-links-list" class="detail-links-list"></div>
                </div>

                <!-- Note Section -->
                <div class="detail-note-box">
                    <label>Notlar</label>
                    <p id="detail-note">Henüz bir not eklenmemiş.</p>
                </div>

                <!-- Action Footer -->
                <div class="detail-footer">
                    <div class="detail-status-row">
                        <span>Durum:</span>
                        <span id="detail-status-text">Satın Alınacak</span>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Settings Modal (Restored) -->
    <div id="modal-settings" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet settings-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title">Ayarlar ⚙️</h2>
                    <p class="sheet-subtitle">Uygulama tercihlerini y&ouml;net.</p>
                </div>
                <button class="close-modal-sheet close-modal-settings" type="button"><i
                        class="fas fa-times"></i></button>
            </div>

            <div class="sheet-body settings-body" style="padding: 1.5rem; overflow-y: auto;">

                <!-- 1. Profile & Name -->
                <div class="settings-section" style="margin-bottom: 2rem;">
                    <h3 class="settings-section-title">
                        <i class="fas fa-user-edit"></i> Profil Bilgileri
                    </h3>
                    <div class="form-group">
                        <label class="settings-label">Sizin İsminiz</label>
                        <div class="input-with-icon" style="position: relative; margin-bottom: 1rem;">
                            <input type="text" id="setting-user-name" class="modern-input"
                                placeholder="İsminizi girin..." style="padding-left: 40px; width: 100%;">
                            <i class="fas fa-signature"
                                style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--primary-color);"></i>
                        </div>

                        <label class="settings-label">Eşinizin İsmi</label>
                        <div class="input-with-icon" style="position: relative;">
                            <input type="text" id="setting-partner-name" class="modern-input"
                                placeholder="Eşinizin ismini girin..." style="padding-left: 40px; width: 100%;">
                            <i class="fas fa-heart-pulse"
                                style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--primary-color);"></i>
                        </div>
                        <p class="settings-help">Uygulama ve giriş ekranındaki isimleri değiştirir.</p>
                    </div>
                </div>

                <!-- 1.5. Special Dates (NEW) -->
                <div class="settings-section" id="settings-dates-section"
                    style="margin-bottom: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                    <h3 class="settings-section-title">
                        <i class="fas fa-calendar-heart"></i> Özel Tarihler
                    </h3>
                    <div class="form-group">
                        <label class="settings-label">Nişan Tarihi</label>
                        <div class="input-with-icon date-input-wrapper"
                            style="position: relative; margin-bottom: 1rem;">
                            <input type="text" id="setting-nisan-date" class="modern-input custom-date-trigger" readonly
                                placeholder="Tarih seçin..." style="padding-left: 40px; width: 100%; cursor: pointer;">
                            <i class="fas fa-ring"
                                style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--primary-color);"></i>
                        </div>

                        <label class="settings-label">Nikah Tarihi</label>
                        <div class="input-with-icon date-input-wrapper" style="position: relative;">
                            <input type="text" id="setting-nikah-date" class="modern-input custom-date-trigger" readonly
                                placeholder="Tarih seçin..." style="padding-left: 40px; width: 100%; cursor: pointer;">
                            <i class="fas fa-dove"
                                style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--primary-color);"></i>
                        </div>
                        <p class="settings-help">Geri sayım sayaçları bu tarihlere göre çalışır.</p>
                    </div>
                </div>

                <!-- 2. Görüntü Ayarları -->
                <div class="settings-section"
                    style="margin-bottom: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                    <h3 class="settings-section-title">
                        <i class="fas fa-magic"></i> Görünüm & Stil
                    </h3>

                    <!-- Background Selection -->
                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label class="settings-label">Tema Arka Planı</label>
                        <div class="bg-picker premium-bg-picker" id="bg-picker-container">
                            <div class="bg-option active" data-bg="simple">
                                <span class="bg-emoji">✨</span>
                                <span class="bg-label">Sade</span>
                            </div>
                            <div class="bg-option" data-bg="floral">
                                <span class="bg-emoji">🪻</span>
                                <span class="bg-label">Bahar</span>
                            </div>
                            <div class="bg-option" data-bg="picnic">
                                <span class="bg-emoji">🧺</span>
                                <span class="bg-label">Piknik</span>
                            </div>
                        </div>
                    </div>

                    <!-- Toggles -->
                    <div class="settings-toggle-row">
                        <div class="toggle-info">
                            <span class="toggle-title">Gece Modu</span>
                            <span class="toggle-desc">Göz yormayan koyu tema</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <div class="settings-toggle-row">
                        <div class="toggle-info">
                            <span class="toggle-title">Efektler</span>
                            <span class="toggle-desc">Görsel animasyonları aç/kapat</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="animations-toggle" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>

                <!-- 3. Kategori Yönetimi -->
                <div class="settings-section"
                    style="margin-bottom: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                    <h3 class="settings-section-title">
                        <i class="fas fa-folder-open"></i> İçerik Yönetimi
                    </h3>
                    <button id="btn-settings-manage-cats" class="btn-ghost-full">
                        <i class="fas fa-tags"></i> Liste Kategorilerini Düzenle
                    </button>
                </div>

                <!-- 4. Veri ve Güvenlik -->
                <div class="settings-section"
                    style="margin-bottom: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                    <h3 class="settings-section-title">
                        <i class="fas fa-shield-alt"></i> Veri & Yedekleme
                    </h3>

                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label class="settings-label">Manuel Yedekleme</label>
                        <div class="data-actions-grid"
                            style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <button id="btn-backup-copy" class="action-btn-mini" title="Yedek dosyasını indir">
                                <i class="fas fa-file-download"></i> Dosya İndir
                            </button>
                            <button id="btn-import-paste" class="action-btn-mini" title="Yedek dosyasını yükle">
                                <i class="fas fa-file-upload"></i> Dosya Yükle
                            </button>
                            <button id="btn-copy-json" class="action-btn-mini" title="Veriyi panoya kopyala">
                                <i class="fas fa-copy"></i> Kodu Kopyala
                            </button>
                            <button id="btn-paste-json" class="action-btn-mini" title="Panodan veri yapıştır">
                                <i class="fas fa-paste"></i> Kod Yapıştır
                            </button>
                        </div>
                        <input type="file" id="backup-file-input" accept=".json, .txt, text/plain, application/json"
                            style="display: none;">
                        <p class="settings-help">Verilerinizi bir dosya olarak saklayabilir veya kod olarak
                            kopyalayabilirsiniz.</p>
                    </div>

                    <!-- Cloud Sync Section -->
                    <div class="cloud-sync-container"
                        style="background: rgba(var(--primary-rgb), 0.05); padding: 1rem; border-radius: 16px; margin-top: 1rem; border: 1px dashed var(--primary-color);">
                        <h4
                            style="margin: 0 0 0.8rem 0; font-size: 0.95rem; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-cloud" style="color: var(--primary-color);"></i> Bulut Senkronizasyonu
                        </h4>
                        <div class="sync-input-group" style="display: flex; gap: 8px;">
                            <input type="text" id="setting-cloud-code" class="modern-input" maxlength="10"
                                placeholder="Ortak Kodunuz..."
                                style="flex: 1; padding: 10px 15px; font-size: 0.9rem; text-transform: uppercase;">
                            <button id="btn-sync-connect" class="btn-primary"
                                style="padding: 0 15px; font-size: 0.85rem; height: 44px; white-space: nowrap;">Bağlan</button>
                        </div>
                        <p class="settings-help" style="margin-top: 8px; font-size: 0.75rem;">Aynı kodu girdiğiniz tüm
                            cihazlar arasında verileriniz anlık olarak senkronize edilir.</p>
                    </div>

                    <button id="btn-reset-app-data" class="btn-danger-minimal" style="margin-top: 1.5rem; width: 100%;">
                        <i class="fas fa-undo"></i> Tüm Verileri Sıfırla
                    </button>
                </div>

                <!-- Special Romantic Section -->
                <div class="special-message-card">
                    <div id="special-message-header" class="card-head clickable"
                        onclick="window.toggleSpecialMessage && window.toggleSpecialMessage()">
                        <h3 class="message-title">
                            <i class="fas fa-heart card-ico"></i> Bir mesajınız var 💌
                        </h3>
                        <i id="message-chevron" class="fas fa-chevron-down"></i>
                    </div>

                    <div id="special-message-content" class="special-message-content">
                        <div class="message-inner">
                            <p id="special-message-text">Canım Şevval'im... ✨</p>
                            <p class="yusuf-sig" id="special-message-signature">- Yusuf</p>
                        </div>
                    </div>
                </div>

                <!-- 5. Bilgi -->
                <div class="settings-footer-info" style="margin-top: 2rem; margin-bottom: 1rem; text-align: center;">
                    <p class="version-info">Versiyon 2.5.0 • Sevgiyle hazırlandı</p>
                </div>
            </div>

            <div class="modal-sheet-footer"
                style="padding: 1rem; border-top: 1px solid var(--border-color); background: var(--bg-color); border-bottom-left-radius: 24px; border-bottom-right-radius: 24px;">
                <button id="btn-save-all-settings" class="btn-primary" style="width: 100%;">Tüm Ayarları Kaydet</button>
            </div>

        </div>
    </div>

    <!-- Category Manager Modal (Added) -->
    <div id="modal-categories" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet settings-sheet">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title">Kategoriler</h2>
                    <p class="sheet-subtitle">Kategorilerini düzenle ve yönet.</p>
                </div>
                <button class="close-modal-sheet close-modal-cats"
                    onclick="window.closeCategoryModal && window.closeCategoryModal()" type="button"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="sheet-body settings-body" id="category-list-container"
                style="padding: 1.5rem; overflow-y: auto;">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>

    <!-- Full Calendar Modal (Active) -->
    <div id="modal-full-calendar" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet calendar-sheet"
            style="height: 85vh; max-height: 85vh; display: flex; flex-direction: column;">
            <div class="modal-sheet-header">
                <div class="sheet-title-area">
                    <h2 class="modal-title">Takvim 🗓️</h2>
                    <p class="sheet-subtitle">Önemli günleri takip et.</p>
                </div>
                <!-- Using window.closeModalHelper explicitly or sticking to app.js event delegation -->
                <button class="close-modal-sheet text-btn" type="button"><i class="fas fa-times"></i></button>
            </div>

            <div class="sheet-body calendar-body"
                style="padding: 0; flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                <!-- Full Calendar Header Controls -->
                <div class="full-calendar-controls">
                    <button id="full-cal-prev" class="btn-icon-sm"><i class="fas fa-chevron-left"></i></button>
                    <div style="text-align: center;">
                        <h3 id="full-cal-month-year">Ocak 2026</h3>
                        <button id="btn-today" class="btn-ghost-sm"
                            style="font-size: 0.7rem; padding: 2px 8px; margin-top: 4px;">Bugüne Dön</button>
                    </div>
                    <button id="full-cal-next" class="btn-icon-sm"><i class="fas fa-chevron-right"></i></button>
                </div>

                <!-- Days Header (Pzt, Sal...) -->
                <div class="calendar-days-header">
                    <span>Pzt</span><span>Sal</span><span>Çar</span><span>Per</span><span>Cum</span><span>Cmt</span><span>Paz</span>
                </div>

                <!-- Calendar Grid (Scrollable) -->
                <div id="full-calendar-grid" class="calendar-grid full-mode">
                    <!-- Days injected by JS -->
                </div>

                <!-- Month Events List (Always Visible) -->
                <div class="section-label-area" style="padding: 0 1.5rem; margin-top: 5px;">
                    <span class="section-label">Aylık Etkinlikler ✨</span>
                </div>
                <div id="month-events-list">
                    <!-- Events injected by JS -->
                </div>

                <!-- Selected Date Details (Hidden by default or simplified) -->
                <div id="calendar-date-details" class="hidden"
                    style="padding: 1rem; border-top: 1px solid var(--border-color); background: var(--card-bg);">
                    <h4 id="selected-date-title" style="margin: 0 0 0.5rem 0; font-size: 1rem;">Seçilen Tarih</h4>
                    <p id="selected-date-info" style="color: var(--text-light); font-size: 0.9rem;"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal (New) -->
    <div id="modal-item-details" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet detail-sheet"
            style="max-width: 450px; border-radius: 28px; overflow: hidden; display: flex; flex-direction: column;">
            <div class="detail-header"
                style="background: var(--primary-color); padding: 2rem 1.5rem; color: white; position: relative;">
                <button class="close-modal-sheet"
                    onclick="window.closeModalHelper(document.getElementById('modal-item-details'))"
                    style="position: absolute; top: 1rem; right: 1rem; background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-times"></i>
                </button>
                <div class="detail-cat-badge" id="detail-category-badge"
                    style="display: inline-flex; align-items: center; gap: 6px; background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; margin-bottom: 0.8rem; font-weight: 600;">
                    <i id="detail-category-icon" class="fas fa-tag"></i>
                    <span id="detail-category-name">Kategori</span>
                </div>
                <h2 id="detail-name" style="margin: 0; font-size: 1.5rem; font-weight: 700; line-height: 1.2;">Ürün Adı
                </h2>
            </div>

            <div class="detail-body" style="padding: 1.5rem; background: var(--card-bg); flex: 1; overflow-y: auto;">
                <div class="detail-info-grid"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                    <div class="detail-info-item"
                        style="background: var(--bg-hover); padding: 1rem; border-radius: 16px;">
                        <span
                            style="display: block; font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin-bottom: 4px;">Adet</span>
                        <span id="detail-quantity"
                            style="font-size: 1.1rem; font-weight: 700; color: var(--text-color);">1</span>
                    </div>
                    <div class="detail-info-item"
                        style="background: var(--bg-hover); padding: 1rem; border-radius: 16px;">
                        <span
                            style="display: block; font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin-bottom: 4px;">Fiyat</span>
                        <span id="detail-price"
                            style="font-size: 1.1rem; font-weight: 700; color: var(--primary-color);">₺0</span>
                    </div>
                </div>

                <div class="detail-notes-section">
                    <h4
                        style="font-size: 0.8rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin: 0 0 0.8rem 0;">
                        Notlar</h4>
                    <div id="detail-notes-container"
                        style="background: var(--bg-hover); padding: 1.2rem; border-radius: 16px; min-height: 80px; position: relative;">
                        <p id="detail-notes"
                            style="margin: 0; font-size: 0.95rem; color: var(--text-color); line-height: 1.6; white-space: pre-wrap; font-style: italic;">
                            Henüz bir not eklenmemiş...</p>
                    </div>
                </div>

                <!-- Fotoğraflar Alanı -->
                <div id="detail-photos-section" style="margin-top: 1.5rem;">
                    <h4
                        style="font-size: 0.8rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin: 0 0 0.8rem 0;">
                        Fotoğraflar</h4>
                    <div id="detail-photos-list" class="detail-photo-grid">
                        <!-- Fotoğraflar JS ile buraya eklenecek -->
                    </div>
                </div>
            </div>

            <div class="detail-footer"
                style="padding: 1rem 1.5rem 1.5rem; background: var(--card-bg); display: flex; gap: 10px; border-top: 1px solid var(--border-color); margin-top: auto;">
                <button id="btn-detail-edit" type="button" class="btn-primary" onclick="window.handleDetailEdit(event)"
                    style="flex: 1; border-radius: 14px; background: var(--text-color); border-color: var(--text-color); display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-edit"></i> Düzenle
                </button>
                <button onclick="window.closeModalHelper(document.getElementById('modal-item-details'))"
                    class="btn-ghost" style="flex: 1; border-radius: 14px; border: 1px solid var(--border-color);">
                    Kapat
                </button>
            </div>
        </div>
    </div>

    <!-- Add Note Modal (Redesigned) -->
    <div id="modal-add-note" class="modal hidden note-modal-overlay">
        <div class="modal-backdrop"></div>
        <div class="modal-content note-modal-card">
            <div class="note-modal-header">
                <div class="note-icon-circle">
                    <i class="fas fa-pen"></i>
                </div>
                <h3 class="modal-title">Not Ekle</h3>
                <p id="note-date-display" class="note-date"></p>
            </div>

            <div class="note-input-wrapper">
                <textarea id="note-input" class="note-textarea" rows="5"
                    placeholder="Bugün için planların, anıların veya notların..."></textarea>
            </div>

            <div class="note-modal-actions">
                <button type="button" class="btn-ghost"
                    onclick="window.closeModalHelper(document.getElementById('modal-add-note'))">Vazgeç</button>
                <button type="button" id="btn-save-note-confirm" class="btn-primary-sculpted">Kaydet</button>
            </div>
        </div>
    </div>




    <!-- Photo Viewer Modal (Lightbox with Zoom) -->
    <div id="modal-image-viewer" class="modal hidden photo-viewer-overlay">
        <div class="modal-backdrop viewer-close-trigger"></div>
        <div id="viewer-dynamic-bg" class="viewer-dynamic-bg"></div> <!-- Dinamik Arka Plan -->
        <div class="viewer-container">
            <div class="viewer-header">
                <button type="button" class="viewer-btn close-viewer viewer-close-trigger"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="viewer-content">
                <div id="viewer-zoom-wrapper" class="zoom-wrapper">
                    <!-- Carousel Layout -->
                    <img id="viewer-prev-image" class="viewer-side-image" src="" alt="">
                    <img id="viewer-image" src="" alt="Tam Ekran Görüntü">
                    <img id="viewer-next-image" class="viewer-side-image" src="" alt="">
                </div>
            </div>
            <!-- Fotoğraf İndikatörleri (Noktalar) -->
            <div id="viewer-indicators" class="viewer-indicators"></div>
        </div>
    </div>

    <!-- Spending History Modal -->
    <div id="modal-spending-history" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet glass-sheet" style="max-height: 80vh; display: flex; flex-direction: column;">
            <div class="modal-sheet-header">
                <div class="sheet-title-area" style="display: flex; align-items: center; gap: 12px;">
                    <div class="sheet-icon" id="history-header-icon"
                        style="background: var(--primary-light); color: var(--primary-dark); border-radius: 12px; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;">
                        <i class="fas fa-history"></i>
                    </div>
                    <div>
                        <h2 class="sheet-title" style="margin: 0; font-size: 1.2rem;">Harcama Geçmişi</h2>
                        <p class="sheet-subtitle" style="margin: 0; font-size: 0.85rem; opacity: 0.7;">Aylık harcama ve
                            bütçe özeti</p>
                    </div>
                </div>
                <button class="close-modal-sheet" type="button"
                    onclick="window.closeModalHelper(document.getElementById('modal-spending-history'))">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="sheet-body" id="history-list-container" style="overflow-y: auto; padding: 1.5rem;">
                <!-- History items will be injected here -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- CONFIRMATION MODAL (CUSTOM) -->
    <div id="modal-confirmation" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content confirmation-modal-content">
            <div class="modal-header">
                <h2 id="confirm-title" style="margin:0; font-size:1.2rem; color:var(--text-color);">Onay</h2>
                <button class="btn-icon" onclick="window.closeModal('modal-confirmation')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="confirm-message" style="margin:1rem 0; color:var(--text-light); line-height:1.5;"></p>
                <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:1.5rem;">
                    <button class="btn-secondary" onclick="window.closeModal('modal-confirmation')"
                        style="flex:1;">İptal</button>
                    <button id="btn-confirm-action" class="btn-primary"
                        style="flex:1; background:var(--error-color); border-color:var(--error-color);">Evet,
                        Sil</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 
         DARE PICKER REBORN: ROOT LEVEL 
         This modal is at the root to avoid any nested container constraints.
    -->
    <div id="modal-date-picker" class="modal hidden">
        <style>
            #modal-date-picker.modal {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                bottom: 0 !important;
                display: flex !important;
                align-items: flex-end !important;
                justify-content: center !important;
                z-index: 2147483647 !important;
                background: rgba(0, 0, 0, 0.45) !important;
                padding: 0 !important;
                margin: 0 !important;
                width: 100vw !important;
                height: 100vh !important;
                max-width: none !important;
                max-height: none !important;
            }

            #modal-date-picker .modal-content-sheet {
                position: absolute !important;
                bottom: 0 !important;
                left: 0 !important;
                right: 0 !important;
                width: 100vw !important;
                /* Force true viewport width */
                min-width: 100vw !important;
                max-width: 100vw !important;
                height: 85vh !important;
                /* Slightly shorter for better balance */
                max-height: 85vh !important;
                background: var(--cal-bg) !important;
                backdrop-filter: blur(40px) !important;
                -webkit-backdrop-filter: blur(40px) !important;
                border-radius: 40px 40px 0 0 !important;
                padding: 3rem 2rem 5rem !important;
                /* Symmetrical padding */
                box-shadow: 0 -20px 80px rgba(0, 0, 0, 0.5) !important;
                border: none !important;
                margin: 0 !important;
                transform: none !important;
                display: flex !important;
                flex-direction: column !important;
                animation: slideUpFinal 0.5s cubic-bezier(0.16, 1, 0.3, 1) !important;
                box-sizing: border-box !important;
            }

            @keyframes slideUpFinal {
                from {
                    transform: translateY(100%);
                }

                to {
                    transform: translateY(0);
                }
            }

            #modal-date-picker .modal-sheet-header {
                margin-bottom: 3rem !important;
                display: flex !important;
                justify-content: space-between !important;
                align-items: center !important;
            }

            #modal-date-picker .modal-title {
                margin: 0;
                font-size: 1.5rem !important;
                /* Smaller title */
                font-weight: 800 !important;
                color: var(--cal-text);
            }

            #modal-date-picker .close-modal-sheet {
                background: hsla(0, 0%, 0%, 0.08);
                border: none;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: var(--cal-text);
                cursor: pointer;
            }

            #modal-date-picker .picker-body {
                flex: 1 !important;
                display: flex !important;
                flex-direction: column !important;
            }

            #modal-date-picker .picker-calendar-header {
                margin-bottom: 2.5rem !important;
                display: flex !important;
                justify-content: space-between !important;
                align-items: center !important;
                padding: 0 0.5rem;
            }

            #modal-date-picker #picker-month-year {
                font-size: 1.6rem !important;
                /* Smaller month name */
                font-weight: 900 !important;
                color: var(--cal-primary) !important;
                letter-spacing: -0.5px;
            }

            #modal-date-picker .picker-days-header {
                display: grid !important;
                grid-template-columns: repeat(7, 1fr) !important;
                margin-bottom: 1.5rem !important;
                text-align: center;
            }

            #modal-date-picker .picker-days-header span {
                font-size: 0.9rem !important;
                font-weight: 800 !important;
                color: var(--cal-primary) !important;
                opacity: 0.6;
            }

            #modal-date-picker .picker-grid {
                display: grid !important;
                grid-template-columns: repeat(7, 1fr) !important;
                gap: 10px !important;
                margin-bottom: 2rem !important;
                justify-items: center;
            }

            #modal-date-picker .picker-day {
                width: 100% !important;
                max-width: 50px !important;
                aspect-ratio: 1 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                font-size: 1.1rem !important;
                /* Smaller day numbers */
                font-weight: 700 !important;
                color: var(--cal-text) !important;
                border-radius: 50% !important;
                /* Circular for better look */
                transition: all 0.2s !important;
                cursor: pointer;
            }

            #modal-date-picker .picker-day.selected {
                background: var(--cal-primary) !important;
                color: white !important;
                box-shadow: 0 4px 12px var(--cal-shadow) !important;
            }

            #modal-date-picker .picker-day.today {
                border: 2px solid var(--cal-primary) !important;
                color: var(--cal-primary) !important;
            }

            #modal-date-picker .picker-day.empty {
                opacity: 0;
                pointer-events: none;
            }

            #modal-date-picker #btn-confirm-date {
                width: 100% !important;
                height: 65px !important;
                font-size: 1.2rem !important;
                font-weight: 800 !important;
                border-radius: 20px !important;
                background: var(--cal-primary) !important;
                color: white !important;
                border: none !important;
                box-shadow: 0 10px 25px var(--cal-shadow) !important;
                cursor: pointer;
                transition: transform 0.2s;
            }

            #modal-date-picker #btn-confirm-date:active {
                transform: scale(0.97);
            }
        </style>
        <div class="modal-backdrop" onclick="window.closeDatePicker()"></div>
        <div class="modal-content-sheet">
            <div class="modal-sheet-header">
                <h2 class="modal-title">Tarih Seçimi 📅</h2>
                <button class="close-modal-sheet" onclick="window.closeDatePicker()"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="picker-body">
                <div class="picker-calendar-header">
                    <button id="picker-prev" class="btn-icon-sm"
                        style="background:none; border:none; color:var(--cal-primary); font-size:1.2rem; cursor:pointer;"><i
                            class="fas fa-chevron-left"></i></button>
                    <span id="picker-month-year">...</span>
                    <button id="picker-next" class="btn-icon-sm"
                        style="background:none; border:none; color:var(--cal-primary); font-size:1.2rem; cursor:pointer;"><i
                            class="fas fa-chevron-right"></i></button>
                </div>
                <div class="picker-days-header">
                    <span>Pzt</span><span>Sal</span><span>Çar</span><span>Per</span><span>Cum</span><span>Cmt</span><span>Paz</span>
                </div>
                <div id="picker-grid" class="picker-grid"></div>
            </div>
            <div class="picker-footer">
                <button id="btn-confirm-date">TARİHİ ONAYLA</button>
            </div>
        </div>
    </div>
    <script src="app.js"></script>

    <script src="missing_funcs.js"></script>
    <script src="touch-drag-support.js"></script>

    <!-- Firebase SDK (v8 Compatibility) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <!-- Custom UI Confirm Modal -->
    <div id="modal-confirm" class="modal hidden" style="z-index: 2147483647;">
        <div class="modal-backdrop"></div>
        <div class="modal-content-sheet confirm-sheet" style="max-width: 320px; border-radius: 20px; overflow: hidden;">
            <div class="sheet-body" style="padding: 1.5rem; text-align: center;">
                <div class="confirm-icon" style="font-size: 2.5rem; color: var(--primary-color); margin-bottom: 1rem;">
                    <i class="fas fa-question-circle"></i>
                </div>
                <h3 id="confirm-title" style="margin-bottom: 0.5rem; font-size: 1.1rem;">Emin misiniz?</h3>
                <p id="confirm-message" style="font-size: 0.9rem; color: var(--text-light); line-height: 1.4;">Bu işlemi
                    onaylıyor musunuz?</p>
            </div>
            <div class="confirm-actions" style="display: flex; border-top: 1px solid var(--border-color);">
                <button id="btn-confirm-cancel" class="btn-ghost"
                    style="flex: 1; padding: 1rem; border: none; border-radius: 0; font-weight: 500; color: var(--text-light);">Vazgeç</button>
                <div style="width: 1px; background: var(--border-color);"></div>
                <button id="btn-confirm-ok" class="btn-ghost"
                    style="flex: 1; padding: 1rem; border: none; border-radius: 0; font-weight: 600; color: var(--primary-color);">Tamam</button>
            </div>
        </div>
    </div>
</body>

</html>